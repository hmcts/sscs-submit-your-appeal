{"type":"auditAdvisory","data":{"resolution":{"id":1770,"path":"applicationinsights-native-metrics>node-pre-gyp>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1770,"created":"2021-08-03T18:11:06.582Z","updated":"2021-08-03T19:07:08.152Z","deleted":null,"title":"Arbitrary File Creation/Overwrite due to insufficient absolute path sanitization","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32804"],"vulnerable_versions":"<3.2.2 || >=4.0.0 <4.4.14 || >=5.0.0 <5.0.6 || >=6.0.0 <6.1.1","patched_versions":">=3.2.2 <4.0.0 || >=4.4.14  <5.0.0 || >=5.0.6 <6.0.0 || >=6.1.1","overview":"The `tar` package has a high severity vulnerability before versions 3.2.2, 4.4.14, 5.0.6, and 6.1.1.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.2, 4.4.14, 5.0.6, 6.1.1 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32804)\n- [Related but distinct advisory involving symlinks](https://www.npmjs.com/advisories/1771)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1770"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1771,"path":"applicationinsights-native-metrics>node-pre-gyp>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1771,"created":"2021-08-03T18:14:17.499Z","updated":"2021-08-03T19:01:35.564Z","deleted":null,"title":"Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32803"],"vulnerable_versions":"<3.2.3 || >=4.0.0 <4.4.15 || >=5.0.0 <5.0.7 || >=6.0.0 <6.1.2","patched_versions":">=3.2.3 <4.0.0 || >=4.4.15  <5.0.0 || >=5.0.7 <6.0.0 || >=6.1.2","overview":"The `tar` package has a high severity vulnerability before versions 3.2.3, 4.4.15, 5.0.7, and 6.1.2.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.3, 4.4.15, 5.0.7, 6.1.2 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32803)\n- [Related but distinct advisory involving absolute paths](https://www.npmjs.com/advisories/1770)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1771"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1770,"path":"node-sass>node-gyp>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1770,"created":"2021-08-03T18:11:06.582Z","updated":"2021-08-03T19:07:08.152Z","deleted":null,"title":"Arbitrary File Creation/Overwrite due to insufficient absolute path sanitization","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32804"],"vulnerable_versions":"<3.2.2 || >=4.0.0 <4.4.14 || >=5.0.0 <5.0.6 || >=6.0.0 <6.1.1","patched_versions":">=3.2.2 <4.0.0 || >=4.4.14  <5.0.0 || >=5.0.6 <6.0.0 || >=6.1.1","overview":"The `tar` package has a high severity vulnerability before versions 3.2.2, 4.4.14, 5.0.6, and 6.1.1.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.2, 4.4.14, 5.0.6, 6.1.1 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32804)\n- [Related but distinct advisory involving symlinks](https://www.npmjs.com/advisories/1771)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1770"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1771,"path":"node-sass>node-gyp>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1771,"created":"2021-08-03T18:14:17.499Z","updated":"2021-08-03T19:01:35.564Z","deleted":null,"title":"Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32803"],"vulnerable_versions":"<3.2.3 || >=4.0.0 <4.4.15 || >=5.0.0 <5.0.7 || >=6.0.0 <6.1.2","patched_versions":">=3.2.3 <4.0.0 || >=4.4.15  <5.0.0 || >=5.0.7 <6.0.0 || >=6.1.2","overview":"The `tar` package has a high severity vulnerability before versions 3.2.3, 4.4.15, 5.0.7, and 6.1.2.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.3, 4.4.15, 5.0.7, 6.1.2 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32803)\n- [Related but distinct advisory involving absolute paths](https://www.npmjs.com/advisories/1770)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1771"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1770,"path":"compression-webpack-plugin>cacache>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1770,"created":"2021-08-03T18:11:06.582Z","updated":"2021-08-03T19:07:08.152Z","deleted":null,"title":"Arbitrary File Creation/Overwrite due to insufficient absolute path sanitization","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32804"],"vulnerable_versions":"<3.2.2 || >=4.0.0 <4.4.14 || >=5.0.0 <5.0.6 || >=6.0.0 <6.1.1","patched_versions":">=3.2.2 <4.0.0 || >=4.4.14  <5.0.0 || >=5.0.6 <6.0.0 || >=6.1.1","overview":"The `tar` package has a high severity vulnerability before versions 3.2.2, 4.4.14, 5.0.6, and 6.1.1.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.2, 4.4.14, 5.0.6, 6.1.1 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32804)\n- [Related but distinct advisory involving symlinks](https://www.npmjs.com/advisories/1771)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1770"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1770,"path":"copy-webpack-plugin>cacache>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1770,"created":"2021-08-03T18:11:06.582Z","updated":"2021-08-03T19:07:08.152Z","deleted":null,"title":"Arbitrary File Creation/Overwrite due to insufficient absolute path sanitization","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32804"],"vulnerable_versions":"<3.2.2 || >=4.0.0 <4.4.14 || >=5.0.0 <5.0.6 || >=6.0.0 <6.1.1","patched_versions":">=3.2.2 <4.0.0 || >=4.4.14  <5.0.0 || >=5.0.6 <6.0.0 || >=6.1.1","overview":"The `tar` package has a high severity vulnerability before versions 3.2.2, 4.4.14, 5.0.6, and 6.1.1.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.2, 4.4.14, 5.0.6, 6.1.1 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32804)\n- [Related but distinct advisory involving symlinks](https://www.npmjs.com/advisories/1771)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1770"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1771,"path":"compression-webpack-plugin>cacache>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1771,"created":"2021-08-03T18:14:17.499Z","updated":"2021-08-03T19:01:35.564Z","deleted":null,"title":"Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32803"],"vulnerable_versions":"<3.2.3 || >=4.0.0 <4.4.15 || >=5.0.0 <5.0.7 || >=6.0.0 <6.1.2","patched_versions":">=3.2.3 <4.0.0 || >=4.4.15  <5.0.0 || >=5.0.7 <6.0.0 || >=6.1.2","overview":"The `tar` package has a high severity vulnerability before versions 3.2.3, 4.4.15, 5.0.7, and 6.1.2.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.3, 4.4.15, 5.0.7, 6.1.2 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32803)\n- [Related but distinct advisory involving absolute paths](https://www.npmjs.com/advisories/1770)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1771"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1771,"path":"copy-webpack-plugin>cacache>tar","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"4.4.13","paths":["applicationinsights-native-metrics>node-pre-gyp>tar"]},{"version":"6.0.5","paths":["compression-webpack-plugin>cacache>tar","copy-webpack-plugin>cacache>tar"]},{"version":"2.2.2","paths":["node-sass>node-gyp>tar"]}],"id":1771,"created":"2021-08-03T18:14:17.499Z","updated":"2021-08-03T19:01:35.564Z","deleted":null,"title":"Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"tar","cves":["CVE-2021-32803"],"vulnerable_versions":"<3.2.3 || >=4.0.0 <4.4.15 || >=5.0.0 <5.0.7 || >=6.0.0 <6.1.2","patched_versions":">=3.2.3 <4.0.0 || >=4.4.15  <5.0.0 || >=5.0.7 <6.0.0 || >=6.1.2","overview":"The `tar` package has a high severity vulnerability before versions 3.2.3, 4.4.15, 5.0.7, and 6.1.2.\n\n### Impact\n\nArbitrary File Creation, Arbitrary File Overwrite, Arbitrary Code Execution\n\n`node-tar` aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. \n\nThis logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. \n\n### Workarounds\n\nUsers may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths.\n\n```js\nconst path = require('path')\nconst tar = require('tar')\n\ntar.x({\n  file: 'archive.tgz',\n  // either add this function...\n  onentry: (entry) => {\n    if (path.isAbsolute(entry.path)) {\n      entry.path = sanitizeAbsolutePathSomehow(entry.path)\n      entry.absolute = path.resolve(entry.path)\n    }\n  },\n\n  // or this one\n  filter: (file, entry) => {\n    if (path.isAbsolute(entry.path)) {\n      return false\n    } else {\n      return true\n    }\n  }\n})\n```\n\nUsers are encouraged to upgrade to the latest patch versions, rather than attempt to sanitize tar input themselves.","recommendation":"Upgrade to version 3.2.3, 4.4.15, 5.0.7, 6.1.2 or later","references":"- [GitHub Advisory](https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9)\n- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-32803)\n- [Related but distinct advisory involving absolute paths](https://www.npmjs.com/advisories/1770)","access":"public","severity":"high","cwe":"CWE-22","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1771"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1500,"path":"gulp>gulp-cli>yargs>yargs-parser","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"5.0.1","paths":["gulp>gulp-cli>yargs>yargs-parser","gulp-cli>yargs>yargs-parser"]}],"id":1500,"created":"2020-03-26T19:21:50.174Z","updated":"2020-05-01T01:05:15.020Z","deleted":null,"title":"Prototype Pollution","found_by":{"link":"","name":"Snyk Security Team","email":""},"reported_by":{"link":"","name":"Snyk Security Team","email":""},"module_name":"yargs-parser","cves":[],"vulnerable_versions":"<13.1.2 || >=14.0.0 <15.0.1 || >=16.0.0 <18.1.2","patched_versions":">=13.1.2 <14.0.0 || >=15.0.1 <16.0.0 || >=18.1.2","overview":"Affected versions of `yargs-parser` are vulnerable to prototype pollution. Arguments are not properly sanitized, allowing an attacker to modify the prototype of `Object`, causing the addition or modification of an existing property that will exist on all objects.  \nParsing the argument `--foo.__proto__.bar baz'` adds a `bar` property with value `baz` to all objects. This is only exploitable if attackers have control over the arguments being passed to `yargs-parser`.\n","recommendation":"Upgrade to versions 13.1.2, 15.0.1, 18.1.1 or later.","references":"- [Snyk Report](https://snyk.io/vuln/SNYK-JS-YARGSPARSER-560381)","access":"public","severity":"low","cwe":"CWE-471","metadata":{"module_type":"","exploitability":1,"affected_components":""},"url":"https://npmjs.com/advisories/1500"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1500,"path":"gulp-cli>yargs>yargs-parser","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"5.0.1","paths":["gulp>gulp-cli>yargs>yargs-parser","gulp-cli>yargs>yargs-parser"]}],"id":1500,"created":"2020-03-26T19:21:50.174Z","updated":"2020-05-01T01:05:15.020Z","deleted":null,"title":"Prototype Pollution","found_by":{"link":"","name":"Snyk Security Team","email":""},"reported_by":{"link":"","name":"Snyk Security Team","email":""},"module_name":"yargs-parser","cves":[],"vulnerable_versions":"<13.1.2 || >=14.0.0 <15.0.1 || >=16.0.0 <18.1.2","patched_versions":">=13.1.2 <14.0.0 || >=15.0.1 <16.0.0 || >=18.1.2","overview":"Affected versions of `yargs-parser` are vulnerable to prototype pollution. Arguments are not properly sanitized, allowing an attacker to modify the prototype of `Object`, causing the addition or modification of an existing property that will exist on all objects.  \nParsing the argument `--foo.__proto__.bar baz'` adds a `bar` property with value `baz` to all objects. This is only exploitable if attackers have control over the arguments being passed to `yargs-parser`.\n","recommendation":"Upgrade to versions 13.1.2, 15.0.1, 18.1.1 or later.","references":"- [Snyk Report](https://snyk.io/vuln/SNYK-JS-YARGSPARSER-560381)","access":"public","severity":"low","cwe":"CWE-471","metadata":{"module_type":"","exploitability":1,"affected_components":""},"url":"https://npmjs.com/advisories/1500"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1662,"path":"@hmcts/one-per-page>connect-redis>redis","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"2.8.0","paths":["@hmcts/one-per-page>connect-redis>redis"]}],"id":1662,"created":"2021-05-04T03:47:22.289Z","updated":"2021-05-04T18:21:16.103Z","deleted":null,"title":"Regular Expression Denial of Service","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"redis","cves":["CVE-2021-29469"],"vulnerable_versions":">=2.6.0 <3.1.1","patched_versions":">=3.1.1","overview":"In `redis` before version 3.1.1, when a client is in monitoring mode, the regex begin used to detected monitor messages could cause exponential backtracking on some strings. This issue could lead to a denial of service.\n\n### Patches\nThe problem was fixed in commit [`2d11b6d`](https://github.com/NodeRedis/node-redis/commit/2d11b6dc9b9774464a91fb4b448bad8bf699629e) and was released in version `3.1.1`.","recommendation":"Upgrade to version 3.1.1 or later","references":"[CVE](https://nvd.nist.gov/vuln/detail/CVE-2021-29469)\n[GitHub Advisory](https://github.com/advisories/GHSA-35q2-47q7-3pc3)\n","access":"public","severity":"low","cwe":"CWE-400","metadata":{"module_type":"","exploitability":3,"affected_components":""},"url":"https://npmjs.com/advisories/1662"}}}
