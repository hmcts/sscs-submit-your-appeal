{% from "components/phase_banner.njk" import phaseBanner %}
{% from "footer/macro.njk" import govukFooter %}

{% block breadcrumbs %}
    {% call phaseBanner(phase, feedbackLink) %}
        {{ banner | safe }}
    {% endcall %}
    {% if not hideBackButton %}
      <a class="govuk-back-link" href="#" onclick="history.go(-1); return false;">Back</a>
    {% endif %}
{% endblock %}

{% block head -%}
    <!-- Google Tag Manager -->
    {% if environment === 'prod' %}
        <!-- Live analytics -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=UuZZs4BGR3tNzCze2MIbBw&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-T56C5T7');</script>
    {% else %}
        <!-- Dev analytics -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=uYQEEAOU5-Kwl3yix5HG_A&gtm_preview=env-87&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-T56C5T7');</script>
    {% endif %}
    <!-- End Google Tag Manager -->
    <link href="{{ asset_path }}vendors~main.css" media="screen" rel="stylesheet" />
    <link href="{{ asset_path }}main.css" media="screen" rel="stylesheet" />
    <input id="asset-path" type="hidden" data-path="{{ asset_path }}">
{% endblock %}


{% block bodyStart %}
    <!-- Google Tag Manager (noscript) -->
    {% if environment === 'prod' %}
        <!-- Live analytics -->
        <noscript><iframe title="Google Tag Management" src="https://www.googletagmanager.com/ns.html?id=GTM-T56C5T7&gtm_auth=UuZZs4BGR3tNzCze2MIbBw&gtm_preview=env-2&gtm_cookies_win=x"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    {% else %}
        <!-- Dev analytics -->
        <noscript><iframe title="Google Tag Management" src="https://www.googletagmanager.com/ns.html?id=GTM-T56C5T7&gtm_auth=uYQEEAOU5-Kwl3yix5HG_A&gtm_preview=env-87&gtm_cookies_win=x"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    {% endif %}
    <!-- End Google Tag Manager (noscript) -->
    <noscript> <img alt="no javascript" src="/assets/images/noJS.png" width="1" height="1" /></noscript>
    
{% endblock %}

{% block footer %}
  {{ govukFooter({
    meta: {
      items: [
        {
          href: "https://hmcts-access.service.gov.uk/contact-us",
          text: "Contact us"
        },
        {
          href: "/terms-and-conditions",
          text: "Terms and conditions"
        },
        {
          href: "/cookie-policy",
          text: "Cookies"
        },
        {
          href: "/privacy-policy",
          text: "Privacy policy"
        }
      ]
    }
  }) }}
{% endblock %}

{% block bodyEnd %}
    <script src="{{ asset_path }}vendors~main.js" type="text/javascript"></script>
    <script src="{{ asset_path }}main.js" type="text/javascript"></script>
    <script src="{{ asset_path }}hmcts-webchat.js"></script>
    <script>
      /*
        * webchat_init() has been developed by CTSC and is defined in hmcts-webchat.js
        * uuid, tenant, channel and other parameters can be passed into it as below to configure
        * and customise the web-chat experience,
        * busHandlerURL: is another jQuery javascript that further customises the web-chat journey
        *
        * NOTE: URLs must be https and not behind a VPN for 8x8 to work with web-chat
        */
        webchat_init(
        {
          uuid: '{{webChat.uuid}}',
          tenant: '{{webChat.tenant}}',
          channel: '{{webChat.channel}}',
          buttonContainerId: 'ctsc-web-chat',
          textChatDown: '{{contactUs.webchat.textChatDown}}',
          textChatWithAnAgent: '{{contactUs.webchat.textChatWithAnAgent}}',
          textNoAgentsAvailable: '{{contactUs.webchat.textNoAgentsAvailable}}',
          textAllAgentsBusy: '{{contactUs.webchat.textAllAgentsBusy}}',
          textChatClosed : '{{contactUs.webchat.textChatClosed}}',
          textChatAlreadyOpen: '{{contactUs.webchat.textChatAlreadyOpen}}',
          textAdditional: '{{contactUs.webchat.textAdditional}}',
          stylesheetURL: '{{baseUrl}}{{ asset_path }}hmcts-webchat.css', 
          busHandlerURL: '{{baseUrl}}{{ asset_path }}hmcts-webchat-busHandler.js', 
          btnNoAgents: '/{{webChat.tenant}}/button_2806315905d232e71137898.81655511/img/logo',
          btnAgentsBusy: '/{{webChat.tenant}}/button_6100617245d23302e383e79.04188400/img/logo',
          btnServiceClosed: '/{{webChat.tenant}}/button_19684351645d232edee71e86.59595908/img/logo'
        }
      );

    // insert before the body
    </script>
{% endblock %}