{% from "components/phase_banner.njk" import phaseBanner %}
{% from "footer/macro.njk" import govukFooter %}

{% block breadcrumbs %}
    {% call phaseBanner(commonContent[htmlLang], feedbackLink + urlPath) %}
        {{ banner }}
    {% endcall %}
    {% if not hideBackButton %}
        <a class="govuk-back-link" href="#">{{ commonContent[htmlLang].back }}</a>
    {% endif %}
{% endblock %}

{% block head -%}
    {% if isIba %}
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
         new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-KZ33DQ42');</script>
        <!-- End Google Tag Manager -->
    {% else %}
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-T56C5T7');</script>
        <!-- End Google Tag Manager -->
    {% endif %}

{% if environment === 'production' %}
<script 
    type="text/javascript" 
    src="https://js-cdn.dynatrace.com/jstag/17177a07246/bf00910jpo/16f5f964ab6c179f_complete.js" 
    crossorigin="anonymous"
    integrity="sha384-S3zjnvflO7BJA6DyU2XOAJ5ekINFsWwl4Nq1ooBVGdTwjmsIOtQ3b/O2rhRaTvrc"></script>
{% else %}
  <!-- Dynatrace manual injection snippet (noscript) -->
  <script 
      type="text/javascript" 
      src="https://js-cdn.dynatrace.com/jstag/17177a07246/bf24054dsx/5757482cea762c9_complete.js" 
      crossorigin="anonymous"
      integrity="sha384-omzYu1Sl/+IPhuNnm18ww9A1jOlB19wfJ8zO/7oc/1Sd7dHgDG3cpSDIrkfsa5/c"></script>
  <!-- End Dynatrace manual injection snippet (noscript) -->
{% endif %}

    <link href="{{ asset_path }}vendors~main.css" media="screen" rel="stylesheet" />
    <link href="{{ asset_path }}main.css" media="screen" rel="stylesheet" />
    <input id="asset-path" type="hidden" data-path="{{ asset_path }}">
{% endblock %}

{% block bodyStart %}
    {% if isIba %}
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src=https://www.googletagmanager.com/ns.html?id=GTM-KZ33DQ42 title="GTM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
    {% else %}
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T56C5T7" title="GTM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
    {% endif %}

    <noscript> <img alt="no javascript" src="/assets/images/noJS.png" width="1" height="1" /></noscript>
{% endblock %}

{% block footer %}
    {{ govukFooter({
        meta: {
            items: [
                {
                    href: "https://hmcts-access.service.gov.uk/contact-us",
                    text: commonContent[htmlLang].footer.contactUs | safe
                },
                {
                    href: "/accessibility",
                    text: commonContent[htmlLang].footer.accessibility | safe
                },
                {
                    href: "/cookie-policy",
                    text: commonContent[htmlLang].footer.cookies | safe
                },
                {
                    href: "/terms-and-conditions",
                    text: commonContent[htmlLang].footer.termsAndConditions | safe
                },
                {
                    href: "/privacy-policy",
                    text: commonContent[htmlLang].footer.privacyPolicy | safe
                }
            ]
        }
    }) }}
{% endblock %}

{% block bodyEnd %}
    <script src="{{ asset_path }}vendors~main.js" type="text/javascript"></script>
    <script src="{{ asset_path }}main.js" type="text/javascript"></script>

{% if featureToggles.cookieBanner() == "true" %}
        <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
{% endif %}

{% endblock %}
